<div id="favorecidosApp" v-cloak>
  <div class="table-wrapper">
    <div class="table-title">
        <div class="row">
            <div class="col-sm-6">
              <h2>Gerenciar <b>Favorecidos</b></h2>
            </div>
            <div class="col-sm-6">
              <a href="#addfavorecidoModal" class="btn btn-success" data-toggle="modal" @click="mountCreateForm()"><i class="material-icons">&#xE147;</i> <span>Adiciona novo favorecido</span></a>
              <a href="#deletefavorecidoModal" class="btn btn-danger" data-toggle="modal" @click="mountDeleteForm()"><i class="material-icons">&#xE15C;</i> <span>Apagar</span></a>
            </div>

        </div>
    </div>
    <table class="table table-striped table-hover">
      <thead>
          <tr>
            <th>
              <span class="custom-checkbox">
                <input type="checkbox" id="selectAll">
                <label for="selectAll"></label>
              </span>
            </th>
            <th>Identificação</th>
            <th>Nome</th>
            <th>Endereço</th>
            <th>Ações</th>
          </tr>
      </thead>
      <tbody>
          <tr v-for="favorecido in favorecidos">
            <td>
              <span class="custom-checkbox">
                <input type="checkbox" :id="'checkbox'+favorecido.id" value="1">
                <label :for="'checkbox'+favorecido.id"></label>
              </span>
            </td>
            <td>{{favorecido.identificador}}</td>
            <td data-toggle="tooltip" :title="'favorecido' + favorecido.tipo">{{favorecido.nome}}</td>
            <td>{{favorecido.endereco.descricao}}</td>
            <td>
              <a href="#editfavorecidoModal" class="edit" data-toggle="modal" @click="mountEditForm(favorecido)"><i class="material-icons" data-toggle="tooltip" title="Editar">&#xE254;</i></a>
              <a href="#deletefavorecidoModal" class="delete" data-toggle="modal" @click="mountDeleteForm(favorecido)"><i class="material-icons" data-toggle="tooltip" title="Apagar">&#xE872;</i></a>
            </td>
          </tr>
      </tbody>
    </table>
    <div class="hint-text">Mostrando <b>{{favorecidos.length}}</b> registros</div>
    <br>
  </div>
  <b-modal ref="formFavorecidoModal" size="lg" title="Conta" >
    <form>
      <v-app>
        <v-content>
          <v-container>
            <v-stepper v-model="step" vertical>
              <v-stepper-header>
                <v-stepper-step step="1" :complete="step > 1">Escolher tipo</v-stepper-step>
                <v-divider></v-divider>
                <v-stepper-step v-if="step == 2" step="2" :complete="step > 2">Suas Informações</v-stepper-step>
                <v-stepper-step v-if="step != 2"  step="3" :complete="step > 3">Suas Informações</v-stepper-step>
                <v-divider></v-divider>
                <v-stepper-step step="4">Contato</v-stepper-step>
              </v-stepper-header>
              <v-stepper-items>
                <v-stepper-content step="1">

                  <v-btn color="primary" @click="step = 2">Fisica</v-btn>
                  <v-btn color="primary" @click="step = 3">Juridica</v-btn>
                </v-stepper-content>
                <v-stepper-content step="2">
                  <v-text-field label="Street" v-model="registration.street" required></v-text-field>
                  <v-text-field label="City" v-model="registration.city" required></v-text-field>
                  <v-text-field label="State" v-model="registration.state" required></v-text-field>

                  <v-btn flat @click="step = 1">Previous</v-btn>
                  <v-btn color="primary" @click="step = 4">Continue</v-btn>

                </v-stepper-content>
                <v-stepper-content step="3">

                  <v-text-field label="Number of Tickets" type="number" v-model="registration.numtickets" required></v-text-field>
                  <v-select label="Shirt Size" v-model="registration.shirtsize" :items="sizes" required></v-select>
                  <v-btn flat @click.native="step = 1">Anterior</v-btn>
                  <v-btn color="primary" @click="step = 4">Continue</v-btn>
                </v-stepper-content>
                <v-stepper-content step="4">

                  <v-text-field label="Number of Tickets" type="number" v-model="registration.numtickets" required></v-text-field>
                  <v-select label="Shirt Size" v-model="registration.shirtsize" :items="sizes" required></v-select>
                  <v-btn flat @click.native="step = 2">Anterior</v-btn>
                  <v-btn color="primary" @click.prevent="submit">Salvar</v-btn>
                </v-stepper-content>
              </v-stepper-items>
            </v-stepper>

          </v-container>

        </v-content>

      </v-app>
    </form>
    <div slot="modal-footer">
      <a class="btn btn-secondary text-light" @click="closeModal">Fechar</a>
      <a class="btn btn-success text-light" @click="createFavorecido(clickedFavorecido)" v-if="create"><span v-if="loading" class="spinner-border spinner-border-sm"></span> Criar</a>
      <a class="btn btn-info text-light" @click="updateFavorecido(clickedFavorecido)" v-if="!create"> Atualizar</a>
    </div>
  </b-modal>
  <b-modal ref="deleteFavorecidoModal" title="Apagar Conta" size="lg" centered>
    <p>Tem certeza que deseja apagar esse registro?</p>
    <p>Nome: {{clickedFavorecido.nome}}</p>
    <p class="text-danger"><small>Esta ação não poderá ser desfeita.</small></p>
    <div slot="modal-footer">
      <a class="btn btn-info text-light" @click="closeModal()">Fechar</a>
      <a class="btn btn-danger text-light" @click="deleteConta(clickedFavorecido.id)">Confirmar</a>
    </div>
  </b-modal>
  </div>
</div>

<%= javascript_pack_tag 'favorecidos', 'data-turbolinks-track': 'reload' %>
